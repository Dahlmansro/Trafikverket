
============================================================

============================================================
============================================================


============================================================
ğŸš‚ TÃ…GDATA PRODUCTION PIPELINE
============================================================


============================================================
============================================================
============================================================

Starttid: 2025-10-21 08:47:14

Mode: Full pipeline (3 steg)


============================================================
============================================================
============================================================

ğŸš€ STEG: 1/3 - HÃ„MTA DATA FRÃ…N API

============================================================
============================================================

============================================================


============================================================

============================================================
============================================================

FETCH TRAIN DATA - START

============================================================
============================================================

============================================================


============================================================
============================================================
============================================================

ğŸš‚ HÃ„MTAR TÃ…GDATA FRÃ…N TRAFIKVERKET

============================================================
============================================================
============================================================

ğŸ“… Period: senaste 3 dagar (exkl. idag)

ğŸ“… HÃ¤mtar data fÃ¶r 2025-10-18
   [01/24] HÃ¤mtar 00:00â€“01:00... 1,438 rader
   [02/24] HÃ¤mtar 01:00â€“02:00... 931 rader
   [03/24] HÃ¤mtar 02:00â€“03:00... 429 rader
   [04/24] HÃ¤mtar 03:00â€“04:00... 146 rader
   [05/24] HÃ¤mtar 04:00â€“05:00... 140 rader
   [06/24] HÃ¤mtar 05:00â€“06:00... 693 rader
   [07/24] HÃ¤mtar 06:00â€“07:00... 1,420 rader
   [08/24] HÃ¤mtar 07:00â€“08:00... 1,905 rader
   [09/24] HÃ¤mtar 08:00â€“09:00... 2,423 rader
   [10/24] HÃ¤mtar 09:00â€“10:00... 2,782 rader
   [11/24] HÃ¤mtar 10:00â€“11:00... 2,861 rader
   [12/24] HÃ¤mtar 11:00â€“12:00... 2,841 rader
   [13/24] HÃ¤mtar 12:00â€“13:00... 2,821 rader
   [14/24] HÃ¤mtar 13:00â€“14:00... 2,807 rader
   [15/24] HÃ¤mtar 14:00â€“15:00... 2,822 rader
   [16/24] HÃ¤mtar 15:00â€“16:00... 2,769 rader
   [17/24] HÃ¤mtar 16:00â€“17:00... 2,863 rader
   [18/24] HÃ¤mtar 17:00â€“18:00... 2,899 rader
   [19/24] HÃ¤mtar 18:00â€“19:00... 2,722 rader
   [20/24] HÃ¤mtar 19:00â€“20:00... 2,500 rader
   [21/24] HÃ¤mtar 20:00â€“21:00... 2,316 rader
   [22/24] HÃ¤mtar 21:00â€“22:00... 2,132 rader
   [23/24] HÃ¤mtar 22:00â€“23:00... 1,981 rader
   [24/24] HÃ¤mtar 23:00â€“00:00... 1,729 rader
âœ… Totalt 48,370 rader fÃ¶r 2025-10-18
ğŸ“Š Separering: 24,247 departures, 24,123 arrivals
âœ… Sparad till Azure: raw/departures_20251018.parquet (24,247 rader)
âœ… Sparad till Azure: raw/arrivals_20251018.parquet (24,123 rader)

ğŸ“… HÃ¤mtar data fÃ¶r 2025-10-19
   [01/24] HÃ¤mtar 00:00â€“01:00... 1,356 rader
   [02/24] HÃ¤mtar 01:00â€“02:00... 1,112 rader
   [03/24] HÃ¤mtar 02:00â€“03:00... 571 rader
   [04/24] HÃ¤mtar 03:00â€“04:00... 243 rader
   [05/24] HÃ¤mtar 04:00â€“05:00... 287 rader
   [06/24] HÃ¤mtar 05:00â€“06:00... 922 rader
   [07/24] HÃ¤mtar 06:00â€“07:00... 1,718 rader
   [08/24] HÃ¤mtar 07:00â€“08:00... 2,370 rader
   [09/24] HÃ¤mtar 08:00â€“09:00... 3,289 rader
   [10/24] HÃ¤mtar 09:00â€“10:00... 4,036 rader
   [11/24] HÃ¤mtar 10:00â€“11:00... 4,330 rader
   [12/24] HÃ¤mtar 11:00â€“12:00... 4,459 rader
   [13/24] HÃ¤mtar 12:00â€“13:00... 4,611 rader
   [14/24] HÃ¤mtar 13:00â€“14:00... 4,582 rader
   [15/24] HÃ¤mtar 14:00â€“15:00... 4,904 rader
   [16/24] HÃ¤mtar 15:00â€“16:00... 4,789 rader
   [17/24] HÃ¤mtar 16:00â€“17:00... 4,949 rader
   [18/24] HÃ¤mtar 17:00â€“18:00... 5,159 rader
   [19/24] HÃ¤mtar 18:00â€“19:00... 5,145 rader
   [20/24] HÃ¤mtar 19:00â€“20:00... 4,978 rader
   [21/24] HÃ¤mtar 20:00â€“21:00... 4,653 rader
   [22/24] HÃ¤mtar 21:00â€“22:00... 4,200 rader
   [23/24] HÃ¤mtar 22:00â€“23:00... 3,576 rader
   [24/24] HÃ¤mtar 23:00â€“00:00... 2,685 rader
âœ… Totalt 78,924 rader fÃ¶r 2025-10-19
ğŸ“Š Separering: 53,977 departures, 24,947 arrivals
âœ… Sparad till Azure: raw/departures_20251019.parquet (53,977 rader)
âœ… Sparad till Azure: raw/arrivals_20251019.parquet (24,947 rader)

ğŸ“… HÃ¤mtar data fÃ¶r 2025-10-20
   [01/24] HÃ¤mtar 00:00â€“01:00... 1,421 rader
   [02/24] HÃ¤mtar 01:00â€“02:00... 373 rader
   [03/24] HÃ¤mtar 02:00â€“03:00... 126 rader
   [04/24] HÃ¤mtar 03:00â€“04:00... 165 rader
   [05/24] HÃ¤mtar 04:00â€“05:00... 895 rader
   [06/24] HÃ¤mtar 05:00â€“06:00... 3,956 rader
   [07/24] HÃ¤mtar 06:00â€“07:00... 6,598 rader
   [08/24] HÃ¤mtar 07:00â€“08:00... 7,402 rader
   [09/24] HÃ¤mtar 08:00â€“09:00... 7,105 rader
   [10/24] HÃ¤mtar 09:00â€“10:00... 6,329 rader
   [11/24] HÃ¤mtar 10:00â€“11:00... 5,596 rader
   [12/24] HÃ¤mtar 11:00â€“12:00... 5,598 rader
   [13/24] HÃ¤mtar 12:00â€“13:00... 5,511 rader
   [14/24] HÃ¤mtar 13:00â€“14:00... 5,669 rader
   [15/24] HÃ¤mtar 14:00â€“15:00... 6,033 rader
   [16/24] HÃ¤mtar 15:00â€“16:00... 6,649 rader
   [17/24] HÃ¤mtar 16:00â€“17:00... 7,331 rader
   [18/24] HÃ¤mtar 17:00â€“18:00... 7,433 rader
   [19/24] HÃ¤mtar 18:00â€“19:00... 6,870 rader
   [20/24] HÃ¤mtar 19:00â€“20:00... 5,875 rader
   [21/24] HÃ¤mtar 20:00â€“21:00... 5,324 rader
   [22/24] HÃ¤mtar 21:00â€“22:00... 4,698 rader
   [23/24] HÃ¤mtar 22:00â€“23:00... 3,861 rader
   [24/24] HÃ¤mtar 23:00â€“00:00... 2,838 rader
âœ… Totalt 113,656 rader fÃ¶r 2025-10-20
ğŸ“Š Separering: 77,766 departures, 35,890 arrivals
âœ… Sparad till Azure: raw/departures_20251020.parquet (77,766 rader)
âœ… Sparad till Azure: raw/arrivals_20251020.parquet (35,890 rader)

============================================================

============================================================
============================================================

ğŸ“Š SAMMANFATTNING

============================================================
============================================================
============================================================

2025-10-18: âœ… Dep | âœ… Arr | 48,370 rader
2025-10-19: âœ… Dep | âœ… Arr | 78,924 rader
2025-10-20: âœ… Dep | âœ… Arr | 113,656 rader

âœ… Lyckades: 3/3 dagar

============================================================
============================================================
============================================================

âœ… âœ… FETCH KLART!

============================================================
============================================================

============================================================

âœ… 
âœ… 1/3 - HÃ„MTA DATA FRÃ…N API SLUTFÃ–RT

============================================================
============================================================
============================================================

ğŸš€ STEG: 2/3 - PROCESSERA RAW â†’ TRIPS

============================================================
============================================================

============================================================


============================================================
============================================================
============================================================

ğŸš† PROCESS TRIPS - START

============================================================
============================================================

============================================================

ğŸ“‹ Processerar senaste 3 dagarna: 20251018, 20251019, 20251020

ğŸ“… Processerar 20251018
   âœ… LÃ¤ste raw/departures_20251018.parquet: 24,247 rader
   âœ… LÃ¤ste raw/arrivals_20251018.parquet: 24,123 rader
   ğŸ“Š Totalt RAW: 48,370 rader
   ğŸ”§ Flatten nested columns
   ğŸ”§ Skapade 10 kolumner frÃ¥n 4 nested-kolumner
   âœ… Extraherade trip_typeoftraffic frÃ¥n TypeOfTraffic_Code
   ğŸ“… Konverterar tidkolumner
   ğŸ—“ï¸ Tilldelar TripDate
   ğŸš† Bygger resor per tÃ¥g-id och datum
   âœ… Totalt 2,213 resor skapade
   ğŸ” Enrichar med station_info
   ğŸ” AnvÃ¤nder kolumn 'LocationSignature' frÃ¥n station_info fÃ¶r join
   Departure-join: 2213/2213 (100.0%) matchade
   Arrival-join: 2213/2213 (100.0%) matchade
   ğŸ·ï¸ DÃ¶per om kolumner
   ğŸ“Š Separering: 2,213 huvudresor, 0 helt instÃ¤llda
   âœ… Sparad: curated/trips_combined_20251018.parquet (2,213 resor)

ğŸ“… Processerar 20251019
   âœ… LÃ¤ste raw/departures_20251019.parquet: 53,977 rader
   âœ… LÃ¤ste raw/arrivals_20251019.parquet: 24,947 rader
   ğŸ“Š Totalt RAW: 78,924 rader
   ğŸ”§ Flatten nested columns
   ğŸ”§ Skapade 10 kolumner frÃ¥n 4 nested-kolumner
   âœ… Extraherade trip_typeoftraffic frÃ¥n TypeOfTraffic_Code
   ğŸ“… Konverterar tidkolumner
   ğŸ—“ï¸ Tilldelar TripDate
   ğŸš† Bygger resor per tÃ¥g-id och datum
   âœ… Totalt 2,232 resor skapade
   ğŸ” Enrichar med station_info
   ğŸ” AnvÃ¤nder kolumn 'LocationSignature' frÃ¥n station_info fÃ¶r join
   Departure-join: 2232/2232 (100.0%) matchade
   Arrival-join: 2232/2232 (100.0%) matchade
   ğŸ·ï¸ DÃ¶per om kolumner
   ğŸ“Š Separering: 2,232 huvudresor, 0 helt instÃ¤llda
   âœ… Sparad: curated/trips_combined_20251019.parquet (2,232 resor)

ğŸ“… Processerar 20251020
   âœ… LÃ¤ste raw/departures_20251020.parquet: 77,766 rader
   âœ… LÃ¤ste raw/arrivals_20251020.parquet: 35,890 rader
   ğŸ“Š Totalt RAW: 113,656 rader
   ğŸ”§ Flatten nested columns
   ğŸ”§ Skapade 10 kolumner frÃ¥n 4 nested-kolumner
   âœ… Extraherade trip_typeoftraffic frÃ¥n TypeOfTraffic_Code
   ğŸ“… Konverterar tidkolumner
   ğŸ—“ï¸ Tilldelar TripDate
   ğŸš† Bygger resor per tÃ¥g-id och datum
   âœ… Totalt 3,395 resor skapade
   ğŸ” Enrichar med station_info
   ğŸ” AnvÃ¤nder kolumn 'LocationSignature' frÃ¥n station_info fÃ¶r join
   Departure-join: 3395/3395 (100.0%) matchade
   Arrival-join: 3395/3395 (100.0%) matchade
   ğŸ·ï¸ DÃ¶per om kolumner
   ğŸ“Š Separering: 3,395 huvudresor, 0 helt instÃ¤llda
   âœ… Sparad: curated/trips_combined_20251020.parquet (3,395 resor)

============================================================

============================================================
============================================================

ğŸ“Š SAMMANFATTNING

============================================================
============================================================
============================================================

âœ… 20251018
âœ… 20251019
âœ… 20251020

âœ… Lyckades: 3/3

============================================================
============================================================
============================================================

âœ… âœ… PROCESS TRIPS KLART!

============================================================
============================================================

============================================================

âœ… 
âœ… 2/3 - PROCESSERA RAW â†’ TRIPS SLUTFÃ–RT

============================================================
============================================================
============================================================

ğŸš€ STEG: 3/3 - KOMBINERA ALLA TRIPS

============================================================
============================================================

============================================================


============================================================
============================================================
============================================================

ğŸ”— COMBINE ALL TRIPS - START

============================================================
============================================================

============================================================

ğŸ” SÃ¶ker efter trips_combined_*.parquet filer...
âœ… Hittade 8 filer:
   - curated/trips_combined_20251013.parquet
   - curated/trips_combined_20251014.parquet
   - curated/trips_combined_20251015.parquet
   - curated/trips_combined_20251016.parquet
   - curated/trips_combined_20251017.parquet
   - curated/trips_combined_20251018.parquet
   - curated/trips_combined_20251019.parquet
   - curated/trips_combined_20251020.parquet

ğŸ“¥ LÃ¤ser 8 filer...
   [1/8] âœ… trips_combined_20251013.parquet: 8,628 rader
   [2/8] âœ… trips_combined_20251014.parquet: 3,388 rader
   [3/8] âœ… trips_combined_20251015.parquet: 7,394 rader
   [4/8] âœ… trips_combined_20251016.parquet: 3,341 rader
   [5/8] âœ… trips_combined_20251017.parquet: 3,317 rader
   [6/8] âœ… trips_combined_20251018.parquet: 2,213 rader
   [7/8] âœ… trips_combined_20251019.parquet: 2,232 rader
   [8/8] âœ… trips_combined_20251020.parquet: 3,395 rader

ğŸ”— Concatenerar 8 DataFrames...
âœ… Total fÃ¶re filtrering: 33,908 rader

ğŸ§¹ Filtrerar dubbletter pÃ¥ (AdvertisedTrainIdent, TripStartDate)...
âœ… Efter filtrering: 29,374 rader
ğŸ—‘ï¸  Borttagna dubbletter: 4,534 (13.4%)
âœ… Sorterad pÃ¥ TripStartDate och AdvertisedTrainIdent

ğŸ’¾ Sparar till curated/trips_combined_total.parquet...
âœ… Sparad till Azure: curated/trips_combined_total.parquet

============================================================

============================================================
============================================================

ğŸ“Š STATISTIK

============================================================
============================================================
============================================================

Totalt antal resor: 29,374
Datumspann: 2025-10-09 till 2025-10-20
Antal unika dagar: 12
Antal unika tÃ¥g-id: 4,004
Antal fÃ¶rsenade resor: 5,539 (18.9%)

============================================================
============================================================
============================================================

âœ… âœ… COMBINE ALL TRIPS KLART!

============================================================
============================================================

============================================================

âœ… 
âœ… 3/3 - KOMBINERA ALLA TRIPS SLUTFÃ–RT

============================================================

============================================================
============================================================

ğŸ“Š PIPELINE SAMMANFATTNING

============================================================
============================================================
============================================================

âœ… Steg 1 (Fetch):   LYCKADES
âœ… Steg 2 (Process): LYCKADES
âœ… Steg 3 (Combine): LYCKADES

Tid: 175.4 sekunder
Sluttid: 2025-10-21 08:50:09

============================================================
============================================================
============================================================

âœ… âœ… HELA PIPELINE SLUTFÃ–RD FRAMGÃ…NGSRIKT!

============================================================
============================================================

============================================================

