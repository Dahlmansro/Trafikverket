
============================================================

============================================================
============================================================


============================================================
ğŸš‚ TÃ…GDATA PRODUCTION PIPELINE
============================================================


============================================================
============================================================
============================================================

Starttid: 2025-10-22 16:30:36

Mode: Full pipeline (3 steg)


============================================================
============================================================
============================================================

ğŸš€ STEG: 1/3 - HÃ„MTA DATA FRÃ…N API

============================================================
============================================================

============================================================


============================================================

============================================================
============================================================

FETCH TRAIN DATA - START

============================================================
============================================================

============================================================


============================================================
============================================================
============================================================

ğŸš‚ HÃ„MTAR TÃ…GDATA FRÃ…N TRAFIKVERKET

============================================================
============================================================
============================================================

ğŸ“… Period: senaste 3 dagar (exkl. idag)

ğŸ“… HÃ¤mtar data fÃ¶r 2025-10-19
   [01/24] HÃ¤mtar 00:00â€“01:00... 0 rader
   [02/24] HÃ¤mtar 01:00â€“02:00... 0 rader
   [03/24] HÃ¤mtar 02:00â€“03:00... 0 rader
   [04/24] HÃ¤mtar 03:00â€“04:00... 0 rader
   [05/24] HÃ¤mtar 04:00â€“05:00... 0 rader
   [06/24] HÃ¤mtar 05:00â€“06:00... 0 rader
   [07/24] HÃ¤mtar 06:00â€“07:00... 0 rader
   [08/24] HÃ¤mtar 07:00â€“08:00... 0 rader
   [09/24] HÃ¤mtar 08:00â€“09:00... 1 rader
   [10/24] HÃ¤mtar 09:00â€“10:00... 1 rader
   [11/24] HÃ¤mtar 10:00â€“11:00... 0 rader
   [12/24] HÃ¤mtar 11:00â€“12:00... 1 rader
   [13/24] HÃ¤mtar 12:00â€“13:00... 9 rader
   [14/24] HÃ¤mtar 13:00â€“14:00... 6 rader
   [15/24] HÃ¤mtar 14:00â€“15:00... 7 rader
   [16/24] HÃ¤mtar 15:00â€“16:00... 4 rader
   [17/24] HÃ¤mtar 16:00â€“17:00... 1 rader
   [18/24] HÃ¤mtar 17:00â€“18:00... 7 rader
   [19/24] HÃ¤mtar 18:00â€“19:00... 5 rader
   [20/24] HÃ¤mtar 19:00â€“20:00... 2 rader
   [21/24] HÃ¤mtar 20:00â€“21:00... 4 rader
   [22/24] HÃ¤mtar 21:00â€“22:00... 3 rader
   [23/24] HÃ¤mtar 22:00â€“23:00... 2 rader
   [24/24] HÃ¤mtar 23:00â€“00:00... 4 rader
âœ… Totalt 57 rader fÃ¶r 2025-10-19
ğŸ“Š Separering: 53 departures, 4 arrivals
âœ… Sparad till Azure: raw/departures_20251019.parquet (53 rader)
âœ… Sparad till Azure: raw/arrivals_20251019.parquet (4 rader)

ğŸ“… HÃ¤mtar data fÃ¶r 2025-10-20
   [01/24] HÃ¤mtar 00:00â€“01:00... 270 rader
   [02/24] HÃ¤mtar 01:00â€“02:00... 284 rader
   [03/24] HÃ¤mtar 02:00â€“03:00... 112 rader
   [04/24] HÃ¤mtar 03:00â€“04:00... 150 rader
   [05/24] HÃ¤mtar 04:00â€“05:00... 880 rader
   [06/24] HÃ¤mtar 05:00â€“06:00... 3,945 rader
   [07/24] HÃ¤mtar 06:00â€“07:00... 6,587 rader
   [08/24] HÃ¤mtar 07:00â€“08:00... 7,393 rader
   [09/24] HÃ¤mtar 08:00â€“09:00... 7,099 rader
   [10/24] HÃ¤mtar 09:00â€“10:00... 6,319 rader
   [11/24] HÃ¤mtar 10:00â€“11:00... 5,589 rader
   [12/24] HÃ¤mtar 11:00â€“12:00... 5,579 rader
   [13/24] HÃ¤mtar 12:00â€“13:00... 5,511 rader
   [14/24] HÃ¤mtar 13:00â€“14:00... 5,669 rader
   [15/24] HÃ¤mtar 14:00â€“15:00... 6,033 rader
   [16/24] HÃ¤mtar 15:00â€“16:00... 6,649 rader
   [17/24] HÃ¤mtar 16:00â€“17:00... 7,331 rader
   [18/24] HÃ¤mtar 17:00â€“18:00... 7,433 rader
   [19/24] HÃ¤mtar 18:00â€“19:00... 6,870 rader
   [20/24] HÃ¤mtar 19:00â€“20:00... 5,875 rader
   [21/24] HÃ¤mtar 20:00â€“21:00... 5,324 rader
   [22/24] HÃ¤mtar 21:00â€“22:00... 4,698 rader
   [23/24] HÃ¤mtar 22:00â€“23:00... 3,861 rader
   [24/24] HÃ¤mtar 23:00â€“00:00... 2,838 rader
âœ… Totalt 112,299 rader fÃ¶r 2025-10-20
ğŸ“Š Separering: 76,868 departures, 35,431 arrivals
âœ… Sparad till Azure: raw/departures_20251020.parquet (76,868 rader)
âœ… Sparad till Azure: raw/arrivals_20251020.parquet (35,431 rader)

ğŸ“… HÃ¤mtar data fÃ¶r 2025-10-21
   [01/24] HÃ¤mtar 00:00â€“01:00... 1,577 rader
   [02/24] HÃ¤mtar 01:00â€“02:00... 426 rader
   [03/24] HÃ¤mtar 02:00â€“03:00... 128 rader
   [04/24] HÃ¤mtar 03:00â€“04:00... 163 rader
   [05/24] HÃ¤mtar 04:00â€“05:00... 908 rader
   [06/24] HÃ¤mtar 05:00â€“06:00... 3,941 rader
   [07/24] HÃ¤mtar 06:00â€“07:00... 6,573 rader
   [08/24] HÃ¤mtar 07:00â€“08:00... 7,395 rader
   [09/24] HÃ¤mtar 08:00â€“09:00... 7,106 rader
   [10/24] HÃ¤mtar 09:00â€“10:00... 6,289 rader
   [11/24] HÃ¤mtar 10:00â€“11:00... 5,557 rader
   [12/24] HÃ¤mtar 11:00â€“12:00... 5,584 rader
   [13/24] HÃ¤mtar 12:00â€“13:00... 5,525 rader
   [14/24] HÃ¤mtar 13:00â€“14:00... 5,697 rader
   [15/24] HÃ¤mtar 14:00â€“15:00... 6,060 rader
   [16/24] HÃ¤mtar 15:00â€“16:00... 6,727 rader
   [17/24] HÃ¤mtar 16:00â€“17:00... 7,366 rader
   [18/24] HÃ¤mtar 17:00â€“18:00... 7,510 rader
   [19/24] HÃ¤mtar 18:00â€“19:00... 6,896 rader
   [20/24] HÃ¤mtar 19:00â€“20:00... 5,884 rader
   [21/24] HÃ¤mtar 20:00â€“21:00... 5,343 rader
   [22/24] HÃ¤mtar 21:00â€“22:00... 4,718 rader
   [23/24] HÃ¤mtar 22:00â€“23:00... 3,865 rader
   [24/24] HÃ¤mtar 23:00â€“00:00... 2,842 rader
âœ… Totalt 114,080 rader fÃ¶r 2025-10-21
ğŸ“Š Separering: 78,056 departures, 36,024 arrivals
âœ… Sparad till Azure: raw/departures_20251021.parquet (78,056 rader)
âœ… Sparad till Azure: raw/arrivals_20251021.parquet (36,024 rader)

============================================================

============================================================
============================================================

ğŸ“Š SAMMANFATTNING

============================================================
============================================================
============================================================

2025-10-19: âœ… Dep | âœ… Arr | 57 rader
2025-10-20: âœ… Dep | âœ… Arr | 112,299 rader
2025-10-21: âœ… Dep | âœ… Arr | 114,080 rader

âœ… Lyckades: 3/3 dagar

============================================================
============================================================
============================================================

âœ… âœ… FETCH KLART!

============================================================
============================================================

============================================================

âœ… 
âœ… 1/3 - HÃ„MTA DATA FRÃ…N API SLUTFÃ–RT

============================================================
============================================================
============================================================

ğŸš€ STEG: 2/3 - PROCESSERA RAW â†’ TRIPS

============================================================
============================================================

============================================================


============================================================
============================================================
============================================================

ğŸš† PROCESS TRIPS - START

============================================================
============================================================

============================================================

ğŸ“‹ Processerar senaste 3 dagarna: 20251019, 20251020, 20251021

ğŸ“… Processerar 20251019
   âœ… LÃ¤ste raw/departures_20251019.parquet: 53 rader
   âœ… LÃ¤ste raw/arrivals_20251019.parquet: 4 rader
   ğŸ“Š Totalt RAW: 57 rader
   ğŸ”§ Flatten nested columns
   ğŸ“… Konverterar tidkolumner
   ğŸ—“ï¸ Tilldelar TripDate
   ğŸš† Bygger resor per tÃ¥g-id och datum
âš ï¸     âš ï¸ Inga resor kunde skapas frÃ¥n rÃ¥data!
âš ï¸     âš ï¸ Inga trips kunde byggas fÃ¶r 20251019

ğŸ“… Processerar 20251020
   âœ… LÃ¤ste raw/departures_20251020.parquet: 76,868 rader
   âœ… LÃ¤ste raw/arrivals_20251020.parquet: 35,431 rader
   ğŸ“Š Totalt RAW: 112,299 rader
   ğŸ”§ Flatten nested columns
   ğŸ”§ Skapade 10 kolumner frÃ¥n 4 nested-kolumner
   âœ… Extraherade trip_typeoftraffic frÃ¥n TypeOfTraffic_Code
   ğŸ“… Konverterar tidkolumner
   ğŸ—“ï¸ Tilldelar TripDate
   ğŸš† Bygger resor per tÃ¥g-id och datum
   âœ… Totalt 3,335 resor skapade
   ğŸ” Enrichar med station_info
   ğŸ” AnvÃ¤nder kolumn 'LocationSignature' frÃ¥n station_info fÃ¶r join
   Departure-join: 3335/3335 (100.0%) matchade
   Arrival-join: 3335/3335 (100.0%) matchade
   ğŸ·ï¸ DÃ¶per om kolumner
   ğŸ“Š Separering: 3,335 huvudresor, 0 helt instÃ¤llda
   âœ… Sparad: curated/trips_combined_20251020.parquet (3,335 resor)

ğŸ“… Processerar 20251021
   âœ… LÃ¤ste raw/departures_20251021.parquet: 78,056 rader
   âœ… LÃ¤ste raw/arrivals_20251021.parquet: 36,024 rader
   ğŸ“Š Totalt RAW: 114,080 rader
   ğŸ”§ Flatten nested columns
   ğŸ”§ Skapade 10 kolumner frÃ¥n 4 nested-kolumner
   âœ… Extraherade trip_typeoftraffic frÃ¥n TypeOfTraffic_Code
   ğŸ“… Konverterar tidkolumner
   ğŸ—“ï¸ Tilldelar TripDate
   ğŸš† Bygger resor per tÃ¥g-id och datum
   âœ… Totalt 3,397 resor skapade
   ğŸ” Enrichar med station_info
   ğŸ” AnvÃ¤nder kolumn 'LocationSignature' frÃ¥n station_info fÃ¶r join
   Departure-join: 3397/3397 (100.0%) matchade
   Arrival-join: 3397/3397 (100.0%) matchade
   ğŸ·ï¸ DÃ¶per om kolumner
   ğŸ“Š Separering: 3,397 huvudresor, 0 helt instÃ¤llda
   âœ… Sparad: curated/trips_combined_20251021.parquet (3,397 resor)

============================================================

============================================================
============================================================

ğŸ“Š SAMMANFATTNING

============================================================
============================================================
============================================================

âŒ 20251019
âœ… 20251020
âœ… 20251021

âœ… Lyckades: 2/3

============================================================
============================================================
============================================================

âœ… âœ… PROCESS TRIPS KLART!

============================================================
============================================================

============================================================

âœ… 
âœ… 2/3 - PROCESSERA RAW â†’ TRIPS SLUTFÃ–RT

============================================================
============================================================
============================================================

ğŸš€ STEG: 3/3 - KOMBINERA ALLA TRIPS

============================================================
============================================================

============================================================


============================================================
============================================================
============================================================

ğŸ”— COMBINE ALL TRIPS - START

============================================================
============================================================

============================================================

ğŸ” SÃ¶ker efter trips_combined_*.parquet filer...
âœ… Hittade 9 filer:
   - curated/trips_combined_20251013.parquet
   - curated/trips_combined_20251014.parquet
   - curated/trips_combined_20251015.parquet
   - curated/trips_combined_20251016.parquet
   - curated/trips_combined_20251017.parquet
   - curated/trips_combined_20251018.parquet
   - curated/trips_combined_20251019.parquet
   - curated/trips_combined_20251020.parquet
   - curated/trips_combined_20251021.parquet

ğŸ“¥ LÃ¤ser 9 filer...
   [1/9] âœ… trips_combined_20251013.parquet: 8,628 rader
   [2/9] âœ… trips_combined_20251014.parquet: 3,388 rader
   [3/9] âœ… trips_combined_20251015.parquet: 7,394 rader
   [4/9] âœ… trips_combined_20251016.parquet: 3,341 rader
   [5/9] âœ… trips_combined_20251017.parquet: 3,317 rader
   [6/9] âœ… trips_combined_20251018.parquet: 2,213 rader
   [7/9] âœ… trips_combined_20251019.parquet: 2,232 rader
   [8/9] âœ… trips_combined_20251020.parquet: 3,335 rader
   [9/9] âœ… trips_combined_20251021.parquet: 3,397 rader

ğŸ”— Concatenerar 9 DataFrames...
âœ… Total fÃ¶re filtrering: 37,245 rader

ğŸ§¹ Filtrerar dubbletter pÃ¥ (AdvertisedTrainIdent, TripStartDate)...
âœ… Efter filtrering: 32,698 rader
ğŸ—‘ï¸  Borttagna dubbletter: 4,547 (12.2%)
âœ… Sorterad pÃ¥ TripStartDate och AdvertisedTrainIdent

ğŸ’¾ Sparar till curated/trips_combined_total.parquet...
âœ… Sparad till Azure: curated/trips_combined_total.parquet

============================================================

============================================================
============================================================

ğŸ“Š STATISTIK

============================================================
============================================================
============================================================

Totalt antal resor: 32,698
Datumspann: 2025-10-09 till 2025-10-21
Antal unika dagar: 13
Antal unika tÃ¥g-id: 4,008
Antal fÃ¶rsenade resor: 6,343 (19.4%)

============================================================
============================================================
============================================================

âœ… âœ… COMBINE ALL TRIPS KLART!

============================================================
============================================================

============================================================

âœ… 
âœ… 3/3 - KOMBINERA ALLA TRIPS SLUTFÃ–RT

============================================================

============================================================
============================================================

ğŸ“Š PIPELINE SAMMANFATTNING

============================================================
============================================================
============================================================

âœ… Steg 1 (Fetch):   LYCKADES
âœ… Steg 2 (Process): LYCKADES
âœ… Steg 3 (Combine): LYCKADES

Tid: 124.6 sekunder
Sluttid: 2025-10-22 16:32:41

============================================================
============================================================
============================================================

âœ… âœ… HELA PIPELINE SLUTFÃ–RD FRAMGÃ…NGSRIKT!

============================================================
============================================================

============================================================

