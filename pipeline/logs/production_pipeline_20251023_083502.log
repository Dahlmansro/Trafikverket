
============================================================

============================================================
============================================================


============================================================
ğŸš‚ TÃ…GDATA PRODUCTION PIPELINE
============================================================


============================================================
============================================================
============================================================

Starttid: 2025-10-23 08:35:02

Mode: Full pipeline (3 steg)


============================================================
============================================================
============================================================

ğŸš€ STEG: 1/3 - HÃ„MTA DATA FRÃ…N API

============================================================
============================================================

============================================================


============================================================

============================================================
============================================================

FETCH TRAIN DATA - START

============================================================
============================================================

============================================================


============================================================
============================================================
============================================================

ğŸš‚ HÃ„MTAR TÃ…GDATA FRÃ…N TRAFIKVERKET

============================================================
============================================================
============================================================

ğŸ“… Period: senaste 3 dagar (exkl. idag)

ğŸ“… HÃ¤mtar data fÃ¶r 2025-10-20
   [01/24] HÃ¤mtar 00:00â€“01:00... 2 rader
   [02/24] HÃ¤mtar 01:00â€“02:00... 0 rader
   [03/24] HÃ¤mtar 02:00â€“03:00... 0 rader
   [04/24] HÃ¤mtar 03:00â€“04:00... 0 rader
   [05/24] HÃ¤mtar 04:00â€“05:00... 0 rader
   [06/24] HÃ¤mtar 05:00â€“06:00... 1 rader
   [07/24] HÃ¤mtar 06:00â€“07:00... 4 rader
   [08/24] HÃ¤mtar 07:00â€“08:00... 7 rader
   [09/24] HÃ¤mtar 08:00â€“09:00... 3 rader
   [10/24] HÃ¤mtar 09:00â€“10:00... 5 rader
   [11/24] HÃ¤mtar 10:00â€“11:00... 1 rader
   [12/24] HÃ¤mtar 11:00â€“12:00... 1 rader
   [13/24] HÃ¤mtar 12:00â€“13:00... 12 rader
   [14/24] HÃ¤mtar 13:00â€“14:00... 7 rader
   [15/24] HÃ¤mtar 14:00â€“15:00... 5 rader
   [16/24] HÃ¤mtar 15:00â€“16:00... 6 rader
   [17/24] HÃ¤mtar 16:00â€“17:00... 17 rader
   [18/24] HÃ¤mtar 17:00â€“18:00... 16 rader
   [19/24] HÃ¤mtar 18:00â€“19:00... 18 rader
   [20/24] HÃ¤mtar 19:00â€“20:00... 22 rader
   [21/24] HÃ¤mtar 20:00â€“21:00... 5 rader
   [22/24] HÃ¤mtar 21:00â€“22:00... 12 rader
   [23/24] HÃ¤mtar 22:00â€“23:00... 5 rader
   [24/24] HÃ¤mtar 23:00â€“00:00... 9 rader
âœ… Totalt 158 rader fÃ¶r 2025-10-20
ğŸ“Š Separering: 154 departures, 4 arrivals
âœ… Sparad till Azure: raw/departures_20251020.parquet (154 rader)
âœ… Sparad till Azure: raw/arrivals_20251020.parquet (4 rader)

ğŸ“… HÃ¤mtar data fÃ¶r 2025-10-21
   [01/24] HÃ¤mtar 00:00â€“01:00... 334 rader
   [02/24] HÃ¤mtar 01:00â€“02:00... 297 rader
   [03/24] HÃ¤mtar 02:00â€“03:00... 117 rader
   [04/24] HÃ¤mtar 03:00â€“04:00... 148 rader
   [05/24] HÃ¤mtar 04:00â€“05:00... 893 rader
   [06/24] HÃ¤mtar 05:00â€“06:00... 3,927 rader
   [07/24] HÃ¤mtar 06:00â€“07:00... 6,560 rader
   [08/24] HÃ¤mtar 07:00â€“08:00... 7,381 rader
   [09/24] HÃ¤mtar 08:00â€“09:00... 7,099 rader
   [10/24] HÃ¤mtar 09:00â€“10:00... 6,281 rader
   [11/24] HÃ¤mtar 10:00â€“11:00... 5,552 rader
   [12/24] HÃ¤mtar 11:00â€“12:00... 5,572 rader
   [13/24] HÃ¤mtar 12:00â€“13:00... 5,525 rader
   [14/24] HÃ¤mtar 13:00â€“14:00... 5,697 rader
   [15/24] HÃ¤mtar 14:00â€“15:00... 6,060 rader
   [16/24] HÃ¤mtar 15:00â€“16:00... 6,727 rader
   [17/24] HÃ¤mtar 16:00â€“17:00... 7,366 rader
   [18/24] HÃ¤mtar 17:00â€“18:00... 7,510 rader
   [19/24] HÃ¤mtar 18:00â€“19:00... 6,896 rader
   [20/24] HÃ¤mtar 19:00â€“20:00... 5,884 rader
   [21/24] HÃ¤mtar 20:00â€“21:00... 5,343 rader
   [22/24] HÃ¤mtar 21:00â€“22:00... 4,718 rader
   [23/24] HÃ¤mtar 22:00â€“23:00... 3,865 rader
   [24/24] HÃ¤mtar 23:00â€“00:00... 2,842 rader
âœ… Totalt 112,594 rader fÃ¶r 2025-10-21
ğŸ“Š Separering: 77,115 departures, 35,479 arrivals
âœ… Sparad till Azure: raw/departures_20251021.parquet (77,115 rader)
âœ… Sparad till Azure: raw/arrivals_20251021.parquet (35,479 rader)

ğŸ“… HÃ¤mtar data fÃ¶r 2025-10-22
   [01/24] HÃ¤mtar 00:00â€“01:00... 1,577 rader
   [02/24] HÃ¤mtar 01:00â€“02:00... 424 rader
   [03/24] HÃ¤mtar 02:00â€“03:00... 135 rader
   [04/24] HÃ¤mtar 03:00â€“04:00... 160 rader
   [05/24] HÃ¤mtar 04:00â€“05:00... 902 rader
   [06/24] HÃ¤mtar 05:00â€“06:00... 3,922 rader
   [07/24] HÃ¤mtar 06:00â€“07:00... 6,539 rader
   [08/24] HÃ¤mtar 07:00â€“08:00... 7,311 rader
   [09/24] HÃ¤mtar 08:00â€“09:00... 7,074 rader
   [10/24] HÃ¤mtar 09:00â€“10:00... 6,310 rader
   [11/24] HÃ¤mtar 10:00â€“11:00... 5,577 rader
   [12/24] HÃ¤mtar 11:00â€“12:00... 5,584 rader
   [13/24] HÃ¤mtar 12:00â€“13:00... 5,531 rader
   [14/24] HÃ¤mtar 13:00â€“14:00... 5,683 rader
   [15/24] HÃ¤mtar 14:00â€“15:00... 6,032 rader
   [16/24] HÃ¤mtar 15:00â€“16:00... 6,710 rader
   [17/24] HÃ¤mtar 16:00â€“17:00... 7,362 rader
   [18/24] HÃ¤mtar 17:00â€“18:00... 7,504 rader
   [19/24] HÃ¤mtar 18:00â€“19:00... 6,902 rader
   [20/24] HÃ¤mtar 19:00â€“20:00... 5,892 rader
   [21/24] HÃ¤mtar 20:00â€“21:00... 5,362 rader
   [22/24] HÃ¤mtar 21:00â€“22:00... 4,714 rader
   [23/24] HÃ¤mtar 22:00â€“23:00... 3,840 rader
   [24/24] HÃ¤mtar 23:00â€“00:00... 2,823 rader
âœ… Totalt 113,870 rader fÃ¶r 2025-10-22
ğŸ“Š Separering: 77,901 departures, 35,969 arrivals
âœ… Sparad till Azure: raw/departures_20251022.parquet (77,901 rader)
âœ… Sparad till Azure: raw/arrivals_20251022.parquet (35,969 rader)

============================================================

============================================================
============================================================

ğŸ“Š SAMMANFATTNING

============================================================
============================================================
============================================================

2025-10-20: âœ… Dep | âœ… Arr | 158 rader
2025-10-21: âœ… Dep | âœ… Arr | 112,594 rader
2025-10-22: âœ… Dep | âœ… Arr | 113,870 rader

âœ… Lyckades: 3/3 dagar

============================================================
============================================================
============================================================

âœ… âœ… FETCH KLART!

============================================================
============================================================

============================================================

âœ… 
âœ… 1/3 - HÃ„MTA DATA FRÃ…N API SLUTFÃ–RT

============================================================
============================================================
============================================================

ğŸš€ STEG: 2/3 - PROCESSERA RAW â†’ TRIPS

============================================================
============================================================

============================================================


============================================================
============================================================
============================================================

ğŸš† PROCESS TRIPS - START

============================================================
============================================================

============================================================

ğŸ“‹ Processerar senaste 3 dagarna: 20251020, 20251021, 20251022

ğŸ“… Processerar 20251020
   âœ… LÃ¤ste raw/departures_20251020.parquet: 154 rader
   âœ… LÃ¤ste raw/arrivals_20251020.parquet: 4 rader
   ğŸ“Š Totalt RAW: 158 rader
   ğŸ”§ Flatten nested columns
   ğŸ“… Konverterar tidkolumner
   ğŸ—“ï¸ Tilldelar TripDate
   ğŸš† Bygger resor per tÃ¥g-id och datum
   âœ… Totalt 3 resor skapade
   ğŸ” Enrichar med station_info
   ğŸ” AnvÃ¤nder kolumn 'LocationSignature' frÃ¥n station_info fÃ¶r join
   Departure-join: 3/3 (100.0%) matchade
   Arrival-join: 3/3 (100.0%) matchade
   ğŸ·ï¸ DÃ¶per om kolumner
   ğŸ“Š Separering: 3 huvudresor, 0 helt instÃ¤llda
   âœ… Sparad: curated/trips_combined_20251020.parquet (3 resor)

ğŸ“… Processerar 20251021
   âœ… LÃ¤ste raw/departures_20251021.parquet: 77,115 rader
   âœ… LÃ¤ste raw/arrivals_20251021.parquet: 35,479 rader
   ğŸ“Š Totalt RAW: 112,594 rader
   ğŸ”§ Flatten nested columns
   ğŸ”§ Skapade 10 kolumner frÃ¥n 4 nested-kolumner
   âœ… Extraherade trip_typeoftraffic frÃ¥n TypeOfTraffic_Code
   ğŸ“… Konverterar tidkolumner
   ğŸ—“ï¸ Tilldelar TripDate
   ğŸš† Bygger resor per tÃ¥g-id och datum
   âœ… Totalt 3,331 resor skapade
   ğŸ” Enrichar med station_info
   ğŸ” AnvÃ¤nder kolumn 'LocationSignature' frÃ¥n station_info fÃ¶r join
   Departure-join: 3331/3331 (100.0%) matchade
   Arrival-join: 3331/3331 (100.0%) matchade
   ğŸ·ï¸ DÃ¶per om kolumner
   ğŸ“Š Separering: 3,331 huvudresor, 0 helt instÃ¤llda
   âœ… Sparad: curated/trips_combined_20251021.parquet (3,331 resor)

ğŸ“… Processerar 20251022
   âœ… LÃ¤ste raw/departures_20251022.parquet: 77,901 rader
   âœ… LÃ¤ste raw/arrivals_20251022.parquet: 35,969 rader
   ğŸ“Š Totalt RAW: 113,870 rader
   ğŸ”§ Flatten nested columns
   ğŸ”§ Skapade 10 kolumner frÃ¥n 4 nested-kolumner
   âœ… Extraherade trip_typeoftraffic frÃ¥n TypeOfTraffic_Code
   ğŸ“… Konverterar tidkolumner
   ğŸ—“ï¸ Tilldelar TripDate
   ğŸš† Bygger resor per tÃ¥g-id och datum
   âœ… Totalt 3,394 resor skapade
   ğŸ” Enrichar med station_info
   ğŸ” AnvÃ¤nder kolumn 'LocationSignature' frÃ¥n station_info fÃ¶r join
   Departure-join: 3394/3394 (100.0%) matchade
   Arrival-join: 3394/3394 (100.0%) matchade
   ğŸ·ï¸ DÃ¶per om kolumner
   ğŸ“Š Separering: 3,394 huvudresor, 0 helt instÃ¤llda
   âœ… Sparad: curated/trips_combined_20251022.parquet (3,394 resor)

============================================================

============================================================
============================================================

ğŸ“Š SAMMANFATTNING

============================================================
============================================================
============================================================

âœ… 20251020
âœ… 20251021
âœ… 20251022

âœ… Lyckades: 3/3

============================================================
============================================================
============================================================

âœ… âœ… PROCESS TRIPS KLART!

============================================================
============================================================

============================================================

âœ… 
âœ… 2/3 - PROCESSERA RAW â†’ TRIPS SLUTFÃ–RT

============================================================
============================================================
============================================================

ğŸš€ STEG: 3/3 - KOMBINERA ALLA TRIPS

============================================================
============================================================

============================================================


============================================================
============================================================
============================================================

ğŸ”— COMBINE ALL TRIPS - START

============================================================
============================================================

============================================================

ğŸ” SÃ¶ker efter trips_combined_*.parquet filer...
âœ… Hittade 10 filer:
   - curated/trips_combined_20251013.parquet
   - curated/trips_combined_20251014.parquet
   - curated/trips_combined_20251015.parquet
   - curated/trips_combined_20251016.parquet
   - curated/trips_combined_20251017.parquet
   - curated/trips_combined_20251018.parquet
   - curated/trips_combined_20251019.parquet
   - curated/trips_combined_20251020.parquet
   - curated/trips_combined_20251021.parquet
   - curated/trips_combined_20251022.parquet

ğŸ“¥ LÃ¤ser 10 filer...
   [1/10] âœ… trips_combined_20251013.parquet: 8,628 rader
   [2/10] âœ… trips_combined_20251014.parquet: 3,388 rader
   [3/10] âœ… trips_combined_20251015.parquet: 7,394 rader
   [4/10] âœ… trips_combined_20251016.parquet: 3,341 rader
   [5/10] âœ… trips_combined_20251017.parquet: 3,317 rader
   [6/10] âœ… trips_combined_20251018.parquet: 2,213 rader
   [7/10] âœ… trips_combined_20251019.parquet: 2,232 rader
   [8/10] âœ… trips_combined_20251020.parquet: 3 rader
   [9/10] âœ… trips_combined_20251021.parquet: 3,331 rader
   [10/10] âœ… trips_combined_20251022.parquet: 3,394 rader

ğŸ”— Concatenerar 10 DataFrames...
âœ… Total fÃ¶re filtrering: 37,241 rader

ğŸ§¹ Filtrerar dubbletter pÃ¥ (AdvertisedTrainIdent, TripStartDate)...
âœ… Efter filtrering: 32,704 rader
ğŸ—‘ï¸  Borttagna dubbletter: 4,537 (12.2%)
âœ… Sorterad pÃ¥ TripStartDate och AdvertisedTrainIdent

ğŸ’¾ Sparar till curated/trips_combined_total.parquet...
âœ… Sparad till Azure: curated/trips_combined_total.parquet

============================================================

============================================================
============================================================

ğŸ“Š STATISTIK

============================================================
============================================================
============================================================

Totalt antal resor: 32,704
Datumspann: 2025-10-09 till 2025-10-22
Antal unika dagar: 14
Antal unika tÃ¥g-id: 4,004
Antal fÃ¶rsenade resor: 6,349 (19.4%)

============================================================
============================================================
============================================================

âœ… âœ… COMBINE ALL TRIPS KLART!

============================================================
============================================================

============================================================

âœ… 
âœ… 3/3 - KOMBINERA ALLA TRIPS SLUTFÃ–RT

============================================================

============================================================
============================================================

ğŸ“Š PIPELINE SAMMANFATTNING

============================================================
============================================================
============================================================

âœ… Steg 1 (Fetch):   LYCKADES
âœ… Steg 2 (Process): LYCKADES
âœ… Steg 3 (Combine): LYCKADES

Tid: 126.2 sekunder
Sluttid: 2025-10-23 08:37:08

============================================================
============================================================
============================================================

âœ… âœ… HELA PIPELINE SLUTFÃ–RD FRAMGÃ…NGSRIKT!

============================================================
============================================================

============================================================

